{% extends "base.html" %}
{% block content %}
<div class="grid" style="grid-template-columns:1.1fr .9fr;gap:16px;align-items:start">
  <div class="card">
    <div class="media" style="height:420px">
      {% if images and images|length > 0 %}
        <img src="{{ images[0].image_url }}" alt="{{ product.name }}">
      {% else %}
        <img src="{{ product.image_url or url_for('static', filename='img/placeholder.jpg') }}" alt="{{ product.name }}">
      {% endif %}
    </div>
    {% if images and images|length > 1 %}
    <div class="card-pad">
      <div class="grid" style="grid-template-columns:repeat(auto-fit,minmax(92px,1fr));gap:10px">
        {% for im in images %}
          <a class="card" style="padding:0;box-shadow:none;border:1px solid rgba(0,0,0,.08);overflow:hidden" href="{{ im.image_url }}" target="_blank">
            <img src="{{ im.image_url }}" style="width:100%;height:86px;object-fit:cover;display:block" alt="Foto {{ loop.index }}">
          </a>
        {% endfor %}
      </div>
    </div>
    {% endif %}
  </div>

  <div class="card">
    <div class="card-pad">
      <h2 style="margin:0 0 6px">{{ product.name }}</h2>
      <div class="muted">{{ product.description }}</div>

      <div class="price">R$ {{ "%.2f"|format(product.price) }}</div>

      {% if pix_discount_percent() > 0 %}
        {% set pix_price = price_with_pix_discount(product.price) %}
        {% set eco = (product.price - pix_price) %}
        <div class="pix">
          <div class="line1">üí∞ {{ pix_discount_percent() }}% OFF no Pix</div>
          <div class="line2">Economia: R$ {{ "%.2f"|format(eco) }} ‚Ä¢ Pix: R$ {{ "%.2f"|format(pix_price) }}</div>
        </div>
      {% endif %}

      <div class="kpis">
        <span class="chip">‚úî Feita √† m√£o</span>
        <span class="chip">‚úî Personaliz√°vel</span>
        <span class="chip">‚úî Envio Brasil</span>
      </div>

      <form method="post" action="{{ url_for('cart_add', product_id=product.id) }}" style="margin-top:14px">
        <div class="form-row">
          <div>
            <label class="muted">Quantidade</label>
            <input type="number" name="qty" value="1" min="1" max="99">
          </div>
          <div style="display:flex;align-items:end">
            <button class="btn primary block">üõçÔ∏è Adicionar ao carrinho</button>
          </div>
        </div>
      </form>

      <a class="btn soft block" style="margin-top:10px" href="{{ url_for('index') }}">‚Üê Voltar ao cat√°logo</a>
    </div>
  </div>
</div>
{% endblock %}
